<header class="task3">
  <h1>Подзадание 1 - напиши функцию <code>delay(ms)</code></h1>
  <a href="./goit-js-hw-11-promisification.html">Назад к заданию 3</a>
</header>
<section class="promis1 promis2">
  <details class="promis3__details" closed="">
    <summary style="color: teal">Задание</summary>
    <p>
      Напиши функцию <code>delay(ms)</code>, которая возвращает промис, переходящий в состояние
      <code>"resolved"</code> через <code>ms</code> миллисекунд. Значением исполнившегося промиса
      должно быть то кол-во миллисекунд которое передали во время вызова функции <code>delay</code>.
    </p>
    <div class="highlight highlight-source-js position-relative">
      <pre><span class="pl-k">const</span> <span class="pl-en">delay</span> <span class="pl-c1">=</span> <span class="pl-s1">ms</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-c">// Change this function</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-en"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">logger</span></span> <span class="pl-c1">=</span> <span class="pl-s1">time</span> <span class="pl-c1">=&gt;</span> <span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s">`Fulfilled after <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">time</span><span class="pl-kos">}</span></span>ms`</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// Tests</span>
<span class="pl-en"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">delay</span></span><span class="pl-kos">(</span><span class="pl-c1">2000</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span><span class="pl-en">logger</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// Fulfilled after 2000ms</span>
<span class="pl-en"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">delay</span></span><span class="pl-kos">(</span><span class="pl-c1">1000</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span><span class="pl-en"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">logger</span></span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// Fulfilled after 1000ms</span>
<span class="pl-en"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">delay</span></span><span class="pl-kos">(</span><span class="pl-c1">1500</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span><span class="pl-en"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">logger</span></span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">// Fulfilled after 1500ms</span></pre>
      <div class="zeroclipboard-container position-absolute right-0 top-0">
        <clipboard-copy
          aria-label="Copy"
          class="ClipboardButton btn js-clipboard-copy m-2 p-0 tooltipped-no-delay"
          data-copy-feedback="Copied!"
          data-tooltip-direction="w"
          value="const delay = ms => {
  // Change this function
};

const logger = time => console.log(`Fulfilled after ${time}ms`);

// Tests
delay(2000).then(logger); // Fulfilled after 2000ms
delay(1000).then(logger); // Fulfilled after 1000ms
delay(1500).then(logger); // Fulfilled after 1500ms
"
          tabindex="0"
          role="button"
        >
        </clipboard-copy>
      </div>
    </div>
  </details>
  <details class="promis3__details" closed="">
    <summary style="color: teal">Решение</summary>
    <pre><code>
const refs = {
    buttons: document.querySelector('.promis1__buttons'),
    result: document.querySelector('.promis1__result'),
    form: document.querySelector('.promis1__form')
}
let promise;
// отображаю кнопки
function addButtons(n) {
    if (n < 3) n = 3;
    let htmlTxt = '';
    for (i = 0; i < n; i++) {
        let number = (Math.floor(Math.random() * (80 - 10)) + 10)*100;
        htmlTxt += `<button>${number}</button>`;
    }
    refs.buttons.innerHTML = htmlTxt;
}
addButtons(Math.random() * 10);

// клик по кнопкам
refs.buttons.addEventListener('click', buttonClick);

function buttonClick(e) {
    e.preventDefault();
    if (e.target.nodeName !== "BUTTON") return;
    const time = Number(e.target.innerText)
    delay(time);
    refs.result.innerHTML = `The program is working. ${time / 1000} sec left`;
        refs.result.style.backgroundColor = 'white';
}

// функция delay()
function delay(ms) {
    const isSuccess = true;
    
    promise = new Promise((resolve, reject) => {
        setTimeout(() => {
            if (isSuccess) {
                resolve(ms);
            } else {
                reject("Error! Error passed to reject function");
            }
        }, ms);
    });
    
    promise.then(
      value => {
        logger(value)
      },
      error => {
        console.log("onReject call inside promise.then()");
        console.log(error); // "Error! Error passed to reject function"
      }
    );
};


function logger(time) {
    console.log(`Fulfilled after ${time}ms`);
    refs.result.innerHTML = `Fulfilled after ${time}ms`;
    refs.result.style.backgroundColor = 'green';
}
</code></pre>
  </details>
</section>
<form action="" class="promis1__form">
  <h3 class="promis1__h3">Список кнопок с различной задержкой</h3>
  <div class="promis1__buttons"></div>
  <h3 class="promis1__h3">Состояние</h3>
  <p class="promis1__result">nothing happens yet</p>
</form>
