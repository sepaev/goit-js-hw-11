<header class="task3">
  <h1>Подзадание 2 - перепиши функцию <code>toggleUserState()</code></h1>
  <a href="./goit-js-hw-11-promisification.html">Назад к заданию 3</a>
</header>
<section class="promis2">
  <details class="promis2__details" closed="">
    <summary style="color: teal">Задание</summary>
    <p>
      Перепиши функцию <code>toggleUserState()</code> так, чтобы она не использовала
      callback-функцию <code>callback</code>, а принимала всего два параметра
      <code>allUsers</code> и <code>username</code> и возвращала промис.
    </p>
    <div class="highlight highlight-source-js position-relative">
      <pre><span class="pl-k">const</span> <span class="pl-s1">users</span> <span class="pl-c1">=</span> <span class="pl-kos">[</span>
  <span class="pl-kos">{</span> <span class="pl-c1">name</span>: <span class="pl-s">'Mango'</span><span class="pl-kos">,</span> <span class="pl-c1">active</span>: <span class="pl-c1">true</span> <span class="pl-kos">}</span><span class="pl-kos">,</span>
  <span class="pl-kos">{</span> <span class="pl-c1">name</span>: <span class="pl-s">'Poly'</span><span class="pl-kos">,</span> <span class="pl-c1">active</span>: <span class="pl-c1">false</span> <span class="pl-kos">}</span><span class="pl-kos">,</span>
  <span class="pl-kos">{</span> <span class="pl-c1">name</span>: <span class="pl-s">'Ajax'</span><span class="pl-kos">,</span> <span class="pl-c1">active</span>: <span class="pl-c1">false</span> <span class="pl-kos">}</span><span class="pl-kos">,</span>
<span class="pl-kos">]</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-en"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">toggleUserState</span></span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-s1">allUsers</span><span class="pl-kos">,</span> <span class="pl-s1">username</span><span class="pl-kos">,</span> <span class="pl-s1">callback</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-k">const</span> <span class="pl-s1">updatedUsers</span> <span class="pl-c1">=</span> <span class="pl-s1">allUsers</span><span class="pl-kos">.</span><span class="pl-en">map</span><span class="pl-kos">(</span><span class="pl-s1">user</span> <span class="pl-c1">=&gt;</span>
    <span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-c1">name</span> <span class="pl-c1">===</span> <span class="pl-s1">username</span> ? <span class="pl-kos">{</span> ...<span class="pl-s1">user</span><span class="pl-kos">,</span> <span class="pl-c1">active</span>: <span class="pl-c1">!</span><span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-c1">active</span> <span class="pl-kos">}</span> : <span class="pl-s1">user</span>
  <span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-s1">callback</span><span class="pl-kos">(</span><span class="pl-s1">updatedUsers</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-c">// Currently the function works like this</span>
<span class="pl-en">toggleUserState</span><span class="pl-kos">(</span><span class="pl-s1">users</span><span class="pl-kos">,</span> <span class="pl-s">'Mango'</span><span class="pl-kos">,</span> <span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-c1">table</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-en">toggleUserState</span><span class="pl-kos">(</span><span class="pl-s1">users</span><span class="pl-kos">,</span> <span class="pl-s">'Ajax'</span><span class="pl-kos">,</span> <span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-c1">table</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// The function should work like this</span>
<span class="pl-en"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">toggleUserState</span></span><span class="pl-kos">(</span><span class="pl-s1">users</span><span class="pl-kos">,</span> <span class="pl-s">'Mango'</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span><span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-c1">table</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-en"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">toggleUserState</span></span><span class="pl-kos">(</span><span class="pl-s1">users</span><span class="pl-kos">,</span> <span class="pl-s">'Ajax'</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span><span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-c1">table</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre>
      <div class="zeroclipboard-container position-absolute right-0 top-0">
        <clipboard-copy
          aria-label="Copy"
          class="ClipboardButton btn js-clipboard-copy m-2 p-0 tooltipped-no-delay"
          data-copy-feedback="Copied!"
          data-tooltip-direction="w"
          value="const users = [
  { name: 'Mango', active: true },
  { name: 'Poly', active: false },
  { name: 'Ajax', active: false },
];

const toggleUserState = (allUsers, username, callback) => {
  const updatedUsers = allUsers.map(user =>
    user.name === username ? { ...user, active: !user.active } : user
  );

  callback(updatedUsers);
};

// Currently the function works like this
toggleUserState(users, 'Mango', console.table);
toggleUserState(users, 'Ajax', console.table);

// The function should work like this
toggleUserState(users, 'Mango').then(console.table);
toggleUserState(users, 'Ajax').then(console.table);
"
          tabindex="0"
          role="button"
        >
        </clipboard-copy>
      </div>
    </div>
  </details>
  <details class="promis2__details" closed="">
    <summary style="color: teal">Решение</summary>
    <pre><code>
const users = [
  { name: 'Mango', active: true },
  { name: 'Poly', active: false },
  { name: 'Ajax', active: false },
];

const toggleUserState = (allUsers, username) => {
    return new Promise((resolve, reject) => {
        const updatedUsers = allUsers.map(user =>
            user.name === username ? { ...user, active: !user.active } : user
        );
        if (updatedUsers) {
            resolve(updatedUsers);
        } else {
            reject('Error');
        }
    });
};  

toggleUserState(users, 'Mango').then(console.table);
toggleUserState(users, 'Ajax').then(console.table); 
</code></pre>
  </details>
</section>
