<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Подзадание 1</title><link rel="stylesheet" href="/goit-js-hw-11/header.df5857ac.css"><link rel="stylesheet" href="/goit-js-hw-11/promis.61dc1646.css"></head><body>  <header class="task3"> <h1>Подзадание 3 - Перепиши функцию <code>makeTransaction()</code></h1> <a href="/goit-js-hw-11/html\goit-js-hw-11-promisification.html">Назад к заданию 3</a> </header><section> <details closed=""> <summary style="color:teal">Задание</summary> <p> Перепиши функцию <code>makeTransaction()</code> так, чтобы она не использовала callback-функции <code>onSuccess</code> и <code>onError</code>, а принимала всего один параметр <code>transaction</code> и возвращала промис. </p> <div class="highlight highlight-source-js position-relative"> <pre><span class="pl-k">const</span> <span class="pl-en"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">randomIntegerFromInterval</span></span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-s1">min</span><span class="pl-kos">,</span> <span class="pl-s1">max</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-k">return</span> <span class="pl-v">Math</span><span class="pl-kos">.</span><span class="pl-en">floor</span><span class="pl-kos">(</span><span class="pl-v">Math</span><span class="pl-kos">.</span><span class="pl-en">random</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">*</span> <span class="pl-kos">(</span><span class="pl-s1">max</span> <span class="pl-c1">-</span> <span class="pl-s1">min</span> <span class="pl-c1">+</span> <span class="pl-c1">1</span><span class="pl-kos">)</span> <span class="pl-c1">+</span> <span class="pl-s1">min</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-en">makeTransaction</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-s1">transaction</span><span class="pl-kos">,</span> <span class="pl-s1">onSuccess</span><span class="pl-kos">,</span> <span class="pl-s1">onError</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-k">const</span> <span class="pl-s1">delay</span> <span class="pl-c1">=</span> <span class="pl-en"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">randomIntegerFromInterval</span></span><span class="pl-kos">(</span><span class="pl-c1">200</span><span class="pl-kos">,</span> <span class="pl-c1">500</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-en">setTimeout</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">const</span> <span class="pl-s1">canProcess</span> <span class="pl-c1">=</span> <span class="pl-v">Math</span><span class="pl-kos">.</span><span class="pl-en">random</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">&gt;</span> <span class="pl-c1">0.3</span><span class="pl-kos">;</span>

    <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">canProcess</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
      <span class="pl-s1">onSuccess</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-c1">id</span>: <span class="pl-s1">transaction</span><span class="pl-kos">.</span><span class="pl-c1">id</span><span class="pl-kos">,</span> <span class="pl-c1">time</span>: <span class="pl-s1">delay</span> <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-kos">{</span>
      <span class="pl-s1">onError</span><span class="pl-kos">(</span><span class="pl-s1">transaction</span><span class="pl-kos">.</span><span class="pl-c1">id</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-s1"><span class="pl-token" data-hydro-click="{&quot;event_type&quot;:&quot;code_navigation.click_on_symbol&quot;,&quot;payload&quot;:{&quot;action&quot;:&quot;click_on_symbol&quot;,&quot;repository_id&quot;:187316928,&quot;ref&quot;:&quot;main&quot;,&quot;language&quot;:&quot;Markdown&quot;,&quot;originating_url&quot;:&quot;https://github.com/goitacademy/javascript-homework/tree/main/v2/09&quot;,&quot;user_id&quot;:14824921}}" data-hydro-click-hmac="bb2448622858d58c02f3b50522938b37ecd35f8330a559c25077eaab6410a1bb">delay</span></span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-en">logSuccess</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-kos">{</span> id<span class="pl-kos">,</span> time <span class="pl-kos">}</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">log</span><span class="pl-kos">(</span><span class="pl-s">`Transaction <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">id</span><span class="pl-kos">}</span></span> processed in <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">time</span><span class="pl-kos">}</span></span>ms`</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-en">logError</span> <span class="pl-c1">=</span> <span class="pl-s1">id</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-smi">console</span><span class="pl-kos">.</span><span class="pl-en">warn</span><span class="pl-kos">(</span><span class="pl-s">`Error processing transaction <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">id</span><span class="pl-kos">}</span></span>. Please try again later.`</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-c">// Currently the function works like this</span>
<span class="pl-en">makeTransaction</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-c1">id</span>: <span class="pl-c1">70</span><span class="pl-kos">,</span> <span class="pl-c1">amount</span>: <span class="pl-c1">150</span> <span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-en">logSuccess</span><span class="pl-kos">,</span> <span class="pl-en">logError</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-en">makeTransaction</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-c1">id</span>: <span class="pl-c1">71</span><span class="pl-kos">,</span> <span class="pl-c1">amount</span>: <span class="pl-c1">230</span> <span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-en">logSuccess</span><span class="pl-kos">,</span> <span class="pl-en">logError</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-en">makeTransaction</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-c1">id</span>: <span class="pl-c1">72</span><span class="pl-kos">,</span> <span class="pl-c1">amount</span>: <span class="pl-c1">75</span> <span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-en">logSuccess</span><span class="pl-kos">,</span> <span class="pl-en">logError</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-en">makeTransaction</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-c1">id</span>: <span class="pl-c1">73</span><span class="pl-kos">,</span> <span class="pl-c1">amount</span>: <span class="pl-c1">100</span> <span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-en">logSuccess</span><span class="pl-kos">,</span> <span class="pl-en">logError</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

<span class="pl-c">// The function should work like this</span>
<span class="pl-en">makeTransaction</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-c1">id</span>: <span class="pl-c1">70</span><span class="pl-kos">,</span> <span class="pl-c1">amount</span>: <span class="pl-c1">150</span> <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span><span class="pl-en">logSuccess</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">catch</span><span class="pl-kos">(</span><span class="pl-en">logError</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-en">makeTransaction</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-c1">id</span>: <span class="pl-c1">71</span><span class="pl-kos">,</span> <span class="pl-c1">amount</span>: <span class="pl-c1">230</span> <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span><span class="pl-en">logSuccess</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">catch</span><span class="pl-kos">(</span><span class="pl-en">logError</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-en">makeTransaction</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-c1">id</span>: <span class="pl-c1">72</span><span class="pl-kos">,</span> <span class="pl-c1">amount</span>: <span class="pl-c1">75</span> <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span><span class="pl-en">logSuccess</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">catch</span><span class="pl-kos">(</span><span class="pl-en">logError</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-en">makeTransaction</span><span class="pl-kos">(</span><span class="pl-kos">{</span> <span class="pl-c1">id</span>: <span class="pl-c1">73</span><span class="pl-kos">,</span> <span class="pl-c1">amount</span>: <span class="pl-c1">100</span> <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">then</span><span class="pl-kos">(</span><span class="pl-en">logSuccess</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">catch</span><span class="pl-kos">(</span><span class="pl-en">logError</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre> <div class="position-absolute right-0 top-0 zeroclipboard-container"> <clipboard-copy aria-label="Copy" class="btn ClipboardButton js-clipboard-copy m-2 p-0 tooltipped-no-delay" data-copy-feedback="Copied!" data-tooltip-direction="w" value="const randomIntegerFromInterval = (min, max) => {
  return Math.floor(Math.random() * (max - min + 1) + min);
};

const makeTransaction = (transaction, onSuccess, onError) => {
  const delay = randomIntegerFromInterval(200, 500);

  setTimeout(() => {
    const canProcess = Math.random() > 0.3;

    if (canProcess) {
      onSuccess({ id: transaction.id, time: delay });
    } else {
      onError(transaction.id);
    }
  }, delay);
};

const logSuccess = ({ id, time }) => {
  console.log(`Transaction ${id} processed in ${time}ms`);
};

const logError = id => {
  console.warn(`Error processing transaction ${id}. Please try again later.`);
};

// Currently the function works like this
makeTransaction({ id: 70, amount: 150 }, logSuccess, logError);
makeTransaction({ id: 71, amount: 230 }, logSuccess, logError);
makeTransaction({ id: 72, amount: 75 }, logSuccess, logError);
makeTransaction({ id: 73, amount: 100 }, logSuccess, logError);

// The function should work like this
makeTransaction({ id: 70, amount: 150 }).then(logSuccess).catch(logError);
makeTransaction({ id: 71, amount: 230 }).then(logSuccess).catch(logError);
makeTransaction({ id: 72, amount: 75 }).then(logSuccess).catch(logError);
makeTransaction({ id: 73, amount: 100 }).then(logSuccess).catch(logError);
" tabindex="0" role="button"> </clipboard-copy> </div> </div> </details> </section>  <script src="/goit-js-hw-11/promis03.f84e1103.js"></script> </body></html>